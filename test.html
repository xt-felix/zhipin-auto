<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>GoodHR 助手测试页面</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .test-section {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .test-section h2 {
            margin-top: 0;
            color: #1a73e8;
        }
        button {
            background: #1a73e8;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #1557b0;
        }
        .log {
            background: #f5f5f5;
            border-radius: 4px;
            padding: 10px;
            margin: 10px 0;
            font-family: monospace;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>GoodHR 助手测试页面</h1>
    
    <div class="test-section">
        <h2>测试沟通处理功能</h2>
        <p>点击下面的按钮来测试沟通处理功能：</p>
        <button id="testCommunication">测试沟通处理功能</button>
        <div id="communicationLog" class="log"></div>
    </div>

    <script>
        // 测试沟通处理功能的脚本

        // 模拟的候选人信息
        const testCandidate = {
            name: "张三",
            age: 28,
            education: "本科",
            university: "清华大学",
            experience: "5年",
            salary: "15K-20K",
            location: "北京",
            extraInfo: [
                { type: "技能", value: "JavaScript, React, Node.js" },
                { type: "证书", value: "计算机二级" }
            ]
        };

        // 模拟的公司信息
        const testCompanyInfo = {
            name: "科技有限公司",
            address: "北京市朝阳区xxx街道",
            size: "50-100人",
            type: "私营企业",
            industry: "互联网",
            description: "我们是一家专注于人工智能技术的创新公司",
            website: "https://www.example.com",
            phone: "010-12345678",
            email: "hr@example.com"
        };

        // 模拟的岗位信息
        const testJobInfo = {
            title: "高级前端工程师",
            duty: "负责前端产品的开发和维护",
            requirement: "熟练掌握React框架，有5年以上前端开发经验",
            experience: "5年以上",
            education: "本科及以上",
            salary: "15K-25K",
            location: "北京",
            type: "全职",
            category: "技术类",
            description: "我们正在寻找一位经验丰富的前端工程师加入我们的团队"
        };

        // 模拟的沟通配置
        const testCommunicationConfig = {
            communicationEnabled: true,
            collectContactMethods: true,
            autoSendGreeting: true,
            autoProcessResume: true
        };

        // 模拟的运行模式配置
        const testRunModeConfig = {
            greetingEnabled: true,
            communicationEnabled: true
        };

        // 添加日志
        function addLog(message) {
            const logElement = document.getElementById('communicationLog');
            logElement.textContent += `[${new Date().toLocaleTimeString()}] ${message}\n`;
            logElement.scrollTop = logElement.scrollHeight;
        }

        // 模拟发送消息到content script
        function sendMessageToContentScript() {
            addLog('开始发送测试消息...');
            
            chrome.tabs.query({active: true, currentWindow: true}, function(tabs) {
                if (chrome.runtime.lastError) {
                    addLog('查询标签页失败: ' + chrome.runtime.lastError.message);
                    return;
                }
                
                if (!tabs || tabs.length === 0) {
                    addLog('未找到活动标签页');
                    return;
                }
                
                chrome.tabs.sendMessage(tabs[0].id, {
                    action: 'COMMUNICATION_PROCESS',
                    data: {
                        companyInfo: testCompanyInfo,
                        jobInfo: testJobInfo,
                        communicationConfig: testCommunicationConfig,
                        runModeConfig: testRunModeConfig
                    }
                }, function(response) {
                    if (chrome.runtime.lastError) {
                        addLog('发送消息失败: ' + chrome.runtime.lastError.message);
                    } else {
                        addLog('消息发送成功: ' + JSON.stringify(response));
                    }
                });
            });
        }

        // 绑定按钮事件
        document.getElementById('testCommunication').addEventListener('click', function() {
            addLog('开始测试沟通处理功能...');
            sendMessageToContentScript();
        });
    </script>
</body>
</html>